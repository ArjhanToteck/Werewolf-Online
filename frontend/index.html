<head>
	<style>
		button {
			height: 25;
			width: 105;
		}

		input {
			height: 25;
		}
	</style>
	<title>Werewolf | ArjhanToteck</title>
	<link rel="icon" href="/favicon.png">
	<link href="https://arjhantoteck.vercel.app/style.css" rel="stylesheet" type="text/css" media="all">
</head>

<body>
	<h1 class="glitch" id="heading" data-text="Werewolf">Werewolf</h1>
	<button onclick="startGame()">Host Game</button>
	<button onclick="joinGame()">Join Game</button>
</body>

<script>
const server = "werewolf.arjhantoteck.repl.co";
let connection;

function startGame() {
	// creates game and gets code
	fetch(`https://${server}/startGame/`, {method: "POST"})
		.then(response => {
			if (response.ok) return response.text()
			throw new Error('Network response was not ok.')
		})
		.then(function(code){

			// sets code
			document.cookie = `code=${code}; expires=Thu, 25 Dec 2999 12:00:00 UTC;`

			// joins game
			console.log(code);
			joinGame(code, prompt("name"), false);
		});
}

function joinGame(code, name, spectator) {
	fetch(`https://${server}/joinGame/${code}/${name}/${spectator}`, {method: "POST"})
		.then(response => {
			if (response.ok) return response.text()
			throw new Error('Network response was not ok.')
		})
		.then(function(password){
			document.cookie = `password=${password}`;

			connection = new WebSocket(`wss://${server}`);
			connection.send("hello world");
		});
}
</script>
